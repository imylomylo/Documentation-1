<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Chapter 11 - Oracles Example | Komodo Documentation</title>
    <meta name="description" content="Documentation for developers building on Komodo">
    
    
    <link rel="preload" href="/assets/css/0.styles.7a5b59db.css" as="style"><link rel="preload" href="/assets/js/app.0159a207.js" as="script"><link rel="preload" href="/assets/js/70.49c1e23f.js" as="script"><link rel="prefetch" href="/assets/js/10.1abc007d.js"><link rel="prefetch" href="/assets/js/100.86e6422e.js"><link rel="prefetch" href="/assets/js/101.527ba523.js"><link rel="prefetch" href="/assets/js/102.0f1f7e5f.js"><link rel="prefetch" href="/assets/js/103.efc53719.js"><link rel="prefetch" href="/assets/js/104.64a934da.js"><link rel="prefetch" href="/assets/js/105.6326590f.js"><link rel="prefetch" href="/assets/js/106.bc52b6ab.js"><link rel="prefetch" href="/assets/js/107.0c3f9e54.js"><link rel="prefetch" href="/assets/js/108.15a26ed3.js"><link rel="prefetch" href="/assets/js/109.85d87adb.js"><link rel="prefetch" href="/assets/js/11.0e4a825b.js"><link rel="prefetch" href="/assets/js/110.a72c6e5e.js"><link rel="prefetch" href="/assets/js/111.dee6199f.js"><link rel="prefetch" href="/assets/js/112.6e80ef98.js"><link rel="prefetch" href="/assets/js/113.b7f8b761.js"><link rel="prefetch" href="/assets/js/114.d4eef182.js"><link rel="prefetch" href="/assets/js/115.f1b71733.js"><link rel="prefetch" href="/assets/js/116.ba45d097.js"><link rel="prefetch" href="/assets/js/117.0ff5d256.js"><link rel="prefetch" href="/assets/js/118.40b794cb.js"><link rel="prefetch" href="/assets/js/119.52af7ac6.js"><link rel="prefetch" href="/assets/js/12.96a4dbb6.js"><link rel="prefetch" href="/assets/js/120.33855840.js"><link rel="prefetch" href="/assets/js/121.a75d99ce.js"><link rel="prefetch" href="/assets/js/122.670cb1bb.js"><link rel="prefetch" href="/assets/js/123.c3cce98b.js"><link rel="prefetch" href="/assets/js/124.65e479ca.js"><link rel="prefetch" href="/assets/js/125.5db663d6.js"><link rel="prefetch" href="/assets/js/126.8f01c9bd.js"><link rel="prefetch" href="/assets/js/127.9977f2ca.js"><link rel="prefetch" href="/assets/js/128.4e199eba.js"><link rel="prefetch" href="/assets/js/129.b0baea52.js"><link rel="prefetch" href="/assets/js/13.1ee078f6.js"><link rel="prefetch" href="/assets/js/130.a2007d19.js"><link rel="prefetch" href="/assets/js/131.3c88abbf.js"><link rel="prefetch" href="/assets/js/132.427dfade.js"><link rel="prefetch" href="/assets/js/133.b8e8af5f.js"><link rel="prefetch" href="/assets/js/134.34aa6ee7.js"><link rel="prefetch" href="/assets/js/135.793b087c.js"><link rel="prefetch" href="/assets/js/136.c4c9b71d.js"><link rel="prefetch" href="/assets/js/137.034d7d5b.js"><link rel="prefetch" href="/assets/js/138.d95818cc.js"><link rel="prefetch" href="/assets/js/139.c7c36a18.js"><link rel="prefetch" href="/assets/js/14.7ffc35cb.js"><link rel="prefetch" href="/assets/js/140.abb83c2d.js"><link rel="prefetch" href="/assets/js/141.cab0123b.js"><link rel="prefetch" href="/assets/js/142.729e07c7.js"><link rel="prefetch" href="/assets/js/143.a02017b3.js"><link rel="prefetch" href="/assets/js/144.0b246ba3.js"><link rel="prefetch" href="/assets/js/145.209847ce.js"><link rel="prefetch" href="/assets/js/146.67ec0c58.js"><link rel="prefetch" href="/assets/js/147.8af42564.js"><link rel="prefetch" href="/assets/js/148.38d38b0c.js"><link rel="prefetch" href="/assets/js/149.f481cb81.js"><link rel="prefetch" href="/assets/js/15.d827f422.js"><link rel="prefetch" href="/assets/js/150.d380bb10.js"><link rel="prefetch" href="/assets/js/151.1bf1b19f.js"><link rel="prefetch" href="/assets/js/152.13fe9d2f.js"><link rel="prefetch" href="/assets/js/153.0a288c5c.js"><link rel="prefetch" href="/assets/js/154.03a81241.js"><link rel="prefetch" href="/assets/js/16.310900d7.js"><link rel="prefetch" href="/assets/js/17.3e8bb7d0.js"><link rel="prefetch" href="/assets/js/18.44806e77.js"><link rel="prefetch" href="/assets/js/19.ffd7802a.js"><link rel="prefetch" href="/assets/js/2.20cea359.js"><link rel="prefetch" href="/assets/js/20.074613df.js"><link rel="prefetch" href="/assets/js/21.1c5a4f08.js"><link rel="prefetch" href="/assets/js/22.6abc8eff.js"><link rel="prefetch" href="/assets/js/23.0c98f1aa.js"><link rel="prefetch" href="/assets/js/24.7082c20f.js"><link rel="prefetch" href="/assets/js/25.a985b64e.js"><link rel="prefetch" href="/assets/js/26.1ef84c4c.js"><link rel="prefetch" href="/assets/js/27.b7cee9e2.js"><link rel="prefetch" href="/assets/js/28.27a2d732.js"><link rel="prefetch" href="/assets/js/29.2c071609.js"><link rel="prefetch" href="/assets/js/3.b450b0f6.js"><link rel="prefetch" href="/assets/js/30.4613b264.js"><link rel="prefetch" href="/assets/js/31.9aa12eb6.js"><link rel="prefetch" href="/assets/js/32.de1de551.js"><link rel="prefetch" href="/assets/js/33.a9252d0a.js"><link rel="prefetch" href="/assets/js/34.d31bf6d5.js"><link rel="prefetch" href="/assets/js/35.820adffc.js"><link rel="prefetch" href="/assets/js/36.717e595f.js"><link rel="prefetch" href="/assets/js/37.554a3c3c.js"><link rel="prefetch" href="/assets/js/38.1c866551.js"><link rel="prefetch" href="/assets/js/39.0b878e08.js"><link rel="prefetch" href="/assets/js/4.903b21ab.js"><link rel="prefetch" href="/assets/js/40.64d896d4.js"><link rel="prefetch" href="/assets/js/41.22a39e2c.js"><link rel="prefetch" href="/assets/js/42.60f4f4bc.js"><link rel="prefetch" href="/assets/js/43.fbdc3e8d.js"><link rel="prefetch" href="/assets/js/44.e7438b06.js"><link rel="prefetch" href="/assets/js/45.84e26d61.js"><link rel="prefetch" href="/assets/js/46.1cf3af13.js"><link rel="prefetch" href="/assets/js/47.ee60528d.js"><link rel="prefetch" href="/assets/js/48.bfb28263.js"><link rel="prefetch" href="/assets/js/49.e32a852f.js"><link rel="prefetch" href="/assets/js/5.d357256b.js"><link rel="prefetch" href="/assets/js/50.7f4c24fd.js"><link rel="prefetch" href="/assets/js/51.78c9cecb.js"><link rel="prefetch" href="/assets/js/52.56b31d0d.js"><link rel="prefetch" href="/assets/js/53.e1fa9af4.js"><link rel="prefetch" href="/assets/js/54.f6e6bdf9.js"><link rel="prefetch" href="/assets/js/55.0b1f6a18.js"><link rel="prefetch" href="/assets/js/56.2c67dd80.js"><link rel="prefetch" href="/assets/js/57.562ab706.js"><link rel="prefetch" href="/assets/js/58.564edfae.js"><link rel="prefetch" href="/assets/js/59.edc1056c.js"><link rel="prefetch" href="/assets/js/6.77a2ef62.js"><link rel="prefetch" href="/assets/js/60.d7b6186e.js"><link rel="prefetch" href="/assets/js/61.aec80a17.js"><link rel="prefetch" href="/assets/js/62.f4b3a08a.js"><link rel="prefetch" href="/assets/js/63.b811cfac.js"><link rel="prefetch" href="/assets/js/64.19a9e382.js"><link rel="prefetch" href="/assets/js/65.b8b229f9.js"><link rel="prefetch" href="/assets/js/66.2278a41b.js"><link rel="prefetch" href="/assets/js/67.01639b56.js"><link rel="prefetch" href="/assets/js/68.80ad1cad.js"><link rel="prefetch" href="/assets/js/69.93619b57.js"><link rel="prefetch" href="/assets/js/7.5c748eda.js"><link rel="prefetch" href="/assets/js/71.4368ed85.js"><link rel="prefetch" href="/assets/js/72.4b738a0d.js"><link rel="prefetch" href="/assets/js/73.c29d2082.js"><link rel="prefetch" href="/assets/js/74.7614b378.js"><link rel="prefetch" href="/assets/js/75.590e2709.js"><link rel="prefetch" href="/assets/js/76.7bb0b796.js"><link rel="prefetch" href="/assets/js/77.b158e400.js"><link rel="prefetch" href="/assets/js/78.d546ff8f.js"><link rel="prefetch" href="/assets/js/79.902d17fa.js"><link rel="prefetch" href="/assets/js/8.52b8b063.js"><link rel="prefetch" href="/assets/js/80.c1388433.js"><link rel="prefetch" href="/assets/js/81.e74bc417.js"><link rel="prefetch" href="/assets/js/82.5fa6f37f.js"><link rel="prefetch" href="/assets/js/83.d914eac5.js"><link rel="prefetch" href="/assets/js/84.0d0bfb7f.js"><link rel="prefetch" href="/assets/js/85.344976f8.js"><link rel="prefetch" href="/assets/js/86.8ce533c6.js"><link rel="prefetch" href="/assets/js/87.49b34263.js"><link rel="prefetch" href="/assets/js/88.465d38ba.js"><link rel="prefetch" href="/assets/js/89.de697707.js"><link rel="prefetch" href="/assets/js/9.bfbcf8fb.js"><link rel="prefetch" href="/assets/js/90.1defd386.js"><link rel="prefetch" href="/assets/js/91.49948d4d.js"><link rel="prefetch" href="/assets/js/92.a93dd69a.js"><link rel="prefetch" href="/assets/js/93.52468d4a.js"><link rel="prefetch" href="/assets/js/94.b2afb430.js"><link rel="prefetch" href="/assets/js/95.ea9c86f1.js"><link rel="prefetch" href="/assets/js/96.925b4e5d.js"><link rel="prefetch" href="/assets/js/97.87d0668e.js"><link rel="prefetch" href="/assets/js/98.3b0ce612.js"><link rel="prefetch" href="/assets/js/99.67c3a2f7.js">
    <link rel="stylesheet" href="/assets/css/0.styles.7a5b59db.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Komodo Documentation</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/basic-docs/start-here/introduction.html" class="nav-link">Start Here</a></div><div class="nav-item"><a href="/whitepaper/introduction.html" class="nav-link">Whitepaper</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Guides</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/komodo/installation.html" class="nav-link">Komodo</a></li><li class="dropdown-item"><!----> <a href="/assetchains/beginner-vps-linux.html" class="nav-link">Asset Chains</a></li><li class="dropdown-item"><!----> <a href="/notary/setup-Komodo-Notary-Node.html" class="nav-link">Notary Nodes</a></li><li class="dropdown-item"><!----> <a href="/mmV1/introduction.html" class="nav-link">Marketmaker V1</a></li></ul></div></div><div class="nav-item"><a href="/cc-jl/introduction.html" class="nav-link">CC Book</a></div><div class="nav-item"><a href="/gui/agama/introduction.html" class="nav-link">Agama</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Resources</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/resources/list-all-KomodoPlatform-repos-links.html" class="nav-link">Komodo Platform</a></li><li class="dropdown-item"><!----> <a href="/resources/third-party-repos-resources.html" class="nav-link">Third Party</a></li></ul></div></div><div class="nav-item"><a href="https://komodoplatform.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  KomodoPlatform.com
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/basic-docs/start-here/introduction.html" class="nav-link">Start Here</a></div><div class="nav-item"><a href="/whitepaper/introduction.html" class="nav-link">Whitepaper</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Guides</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/komodo/installation.html" class="nav-link">Komodo</a></li><li class="dropdown-item"><!----> <a href="/assetchains/beginner-vps-linux.html" class="nav-link">Asset Chains</a></li><li class="dropdown-item"><!----> <a href="/notary/setup-Komodo-Notary-Node.html" class="nav-link">Notary Nodes</a></li><li class="dropdown-item"><!----> <a href="/mmV1/introduction.html" class="nav-link">Marketmaker V1</a></li></ul></div></div><div class="nav-item"><a href="/cc-jl/introduction.html" class="nav-link">CC Book</a></div><div class="nav-item"><a href="/gui/agama/introduction.html" class="nav-link">Agama</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Resources</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/resources/list-all-KomodoPlatform-repos-links.html" class="nav-link">Komodo Platform</a></li><li class="dropdown-item"><!----> <a href="/resources/third-party-repos-resources.html" class="nav-link">Third Party</a></li></ul></div></div><div class="nav-item"><a href="https://komodoplatform.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  KomodoPlatform.com
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/cc-jl/introduction.html" class="sidebar-link">How to write UTXO based CC modules for KMD based chains - by jl777</a></li><li><a href="/cc-jl/chapter00.html" class="sidebar-link">Chapter 00 - Bitcoin Protocol Basics</a></li><li><a href="/cc-jl/chapter01.html" class="sidebar-link">Chapter 01 - OP_CHECKCRYPTOCONDITION</a></li><li><a href="/cc-jl/chapter02.html" class="sidebar-link">Chapter 02 - CC Contract Basics</a></li><li><a href="/cc-jl/chapter03.html" class="sidebar-link">Chapter 03 - CC vins and vouts</a></li><li><a href="/cc-jl/chapter04.html" class="sidebar-link">Chapter 04 - CC RPC Extensions</a></li><li><a href="/cc-jl/chapter05.html" class="sidebar-link">Chapter 05 - CC Validation</a></li><li><a href="/cc-jl/chapter06.html" class="sidebar-link">Chapter 06 - Faucet Example</a></li><li><a href="/cc-jl/chapter07.html" class="sidebar-link">Chapter 07 - Rewards Example</a></li><li><a href="/cc-jl/chapter08.html" class="sidebar-link">Chapter 08 - Assets Example</a></li><li><a href="/cc-jl/chapter09.html" class="sidebar-link">Chapter 09 - Dice Example</a></li><li><a href="/cc-jl/chapter10.html" class="sidebar-link">Chapter 10 - Channels Example</a></li><li><a href="/cc-jl/chapter11.html" class="active sidebar-link">Chapter 11 - Oracles Example</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cc-jl/chapter11.html#the-following-are-the-rpc-calls" class="sidebar-link">The following are the rpc calls:</a></li><li class="sidebar-sub-header"><a href="/cc-jl/chapter11.html#vin-vout-allocation" class="sidebar-link">VIN/VOUT allocation</a></li></ul></li><li><a href="/cc-jl/chapter12.html" class="sidebar-link">Chapter 12 - Limitless Possibilities</a></li><li><a href="/cc-jl/chapter13.html" class="sidebar-link">Chapter 13 - Different Languages</a></li><li><a href="/cc-jl/chapter14.html" class="sidebar-link">Chapter 14 - Runtime Bindings</a></li><li><a href="/cc-jl/chapter15.html" class="sidebar-link">Chapter 15 - RPC based dAPPS</a></li><li><a href="/cc-jl/faq.html" class="sidebar-link">Frequently asked Questions</a></li></ul> </div> <div class="page"> <div class="content"><h1 id="chapter-11-oracles-example"><a href="#chapter-11-oracles-example" aria-hidden="true" class="header-anchor">#</a> Chapter 11 - Oracles Example</h1> <p><a href="https://github.com/jl777/komodo/blob/jl777/src/cc/oracles.cpp" target="_blank" rel="noopener noreferrer">Oracles CC<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> is an example where it ended up being simpler than I first expected, but at the same time a lot more powerful. It is one of the smaller CC, but it enables creation of an arbitrary number of data markets, in a performant way.</p> <p>In order to gain the performance, some clever usage of special addresses was needed. It was a bit tricky to generate a special address to keep track of the latest data.</p> <p>Let's back up to the beginning. Just what is an oracle? In this context it is something that puts data that is not on the blockchain, onto the blockchain. Since everything other than the transactions and blocks are not in the blockchain, there is a very large universe of data that can be oracle-ized. It can be literally anything, from the obvious like prices to specific results relative to an arbitrary description.</p> <p>The most difficult issue about oracles is that they need to be trusted to various degree to provide accurate and timely data. The danger is that if a trusted node is used to write data to the blockchain, it creates a trust point and a single point of attack. Ultimately there is nothing that can ensure only valid data is written to the blockchain, so what is done is to reinforce good behavior via pay per datapoint. However, for critical data, higher level processing is needed that combines multiple data providers into a validated signal.</p> <p>At the oracles CC level, it is enough that there is financial incentive to provide good data. Also it is needed to allow multiple vendors for each data that is required and to enable efficient ways to update and query the data.</p> <h2 id="the-following-are-the-rpc-calls"><a href="#the-following-are-the-rpc-calls" aria-hidden="true" class="header-anchor">#</a> The following are the rpc calls:</h2> <div class="language-bash extra-class"><pre class="language-bash"><code>oraclescreate name description <span class="token function">format</span>
oracleslist
oraclesinfo oracletxid
oraclesregister oracletxid datafee
oraclessubscribe oracletxid publisher amount
oraclesdata oracletxid hexstr
oraclessamples oracletxid batonutxo num
</code></pre></div><p>The first step is to create a specific data description with <code>oraclescreate</code>, which also defines the format of the binary data. This creates an oracletxid, which is used in the other rpc calls. <code>name</code> and <code>description</code> are just arbitrary strings, with name preferably being a short name used to access the data. The format is a string comprised of a single character per data element:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token string">'s'</span> -<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>256 char string
<span class="token string">'S'</span> -<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>65536 char string
<span class="token string">'d'</span> -<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>256 binary data
<span class="token string">'D'</span> -<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>65536 binary data
<span class="token string">'c'</span> -<span class="token operator">&gt;</span> 1 byte signed little endian number, <span class="token string">'C'</span> unsigned
<span class="token string">'t'</span> -<span class="token operator">&gt;</span> 2 byte signed little endian number, <span class="token string">'T'</span> unsigned
<span class="token string">'i'</span> -<span class="token operator">&gt;</span> 4 byte signed little endian number, <span class="token string">'I'</span> unsigned
<span class="token string">'l'</span> -<span class="token operator">&gt;</span> 8 byte signed little endian number, <span class="token string">'L'</span> unsigned
<span class="token string">'h'</span> -<span class="token operator">&gt;</span> 32 byte <span class="token function">hash</span>
</code></pre></div><p>For example, if the datapoint is comprised of a <code>4byte</code> timestamp and an <code>8byte</code> number the format string would be: <code>&quot;IL&quot;</code></p> <p><code>oracleslist</code> displays a list of all the <code>oraclestxid</code> and <code>oraclesinfo</code> displays information about the specific <code>oracletxid</code>. Each <code>oracletxid</code> deterministically generates a marker address and a small amount is sent to that address to mark a transaction's relation to the <code>oracltxid</code>.</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;result&quot;</span><span class="token operator">:</span> <span class="token string">&quot;success&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;txid&quot;</span><span class="token operator">:</span> <span class="token string">&quot;4895f631316a649e216153aee7a574bd281686265dc4e8d37597f72353facac3&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;BTCUSD&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;coindeskpricedata&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;format&quot;</span><span class="token operator">:</span> <span class="token string">&quot;L&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;marker&quot;</span><span class="token operator">:</span> <span class="token string">&quot;RVqJCSrdBm1gYJZS1h7dgtHioA5TEYzNRk&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;registered&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;publisher&quot;</span><span class="token operator">:</span> <span class="token string">&quot;02ebc786cb83de8dc3922ab83c21f3f8a2f3216940c3bf9da43ce39e2a3a882c92&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;baton&quot;</span><span class="token operator">:</span> <span class="token string">&quot;RKY4zmHJZ5mNtf6tfKE5VMsKoV71Euej3i&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;batontxid&quot;</span><span class="token operator">:</span> <span class="token string">&quot;4de10b01242ce1a5e29d5fbb03098b4519976879e05ad0458ef7174ed9127f18&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;lifetime&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1.50000000&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;funds&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0.01000000&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;datafee&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0.01000000&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>A <code>data publisher</code> needs to register a <code>datafee</code> and their <code>pubkey</code> for a specific <code>oracletxid</code>. <code>datafee</code> needs to be at least as big as a <code>txfee</code>. Using <code>oraclesregister</code> the current <code>datafee</code> can be updated so a <code>publisher</code> can adapt to market conditions. Once registered, subscribers can prepay for some number of datapoints to a specific <code>publisher</code> using the <code>oraclessubscribe</code> rpc. At first, it is likely that the <code>publisher</code> would pay themselves to enable the posting of initial data points so the potential subscribers can evaluate the quality and consistency of the data.</p> <p>The one final rpc is <code>oraclessamples</code>, which returns the most recent samples of data from a specific <code>publisher</code>. In order to have a performant solution to track all the potential data streams from all the publishers for all the <code>oracletxid</code>, a baton <code>utxo</code> is used. This is an output sent to a specific address and expected to have just a single <code>utxo</code> at any given time to allow for direct lookup. <code>oraclessamples</code> requires a starting <code>txid</code> to use and with each datapoint having the prior <code>batontxid</code>, there is a reverse linked list to traverse the most recent data.</p> <h2 id="vin-vout-allocation"><a href="#vin-vout-allocation" aria-hidden="true" class="header-anchor">#</a> VIN/VOUT allocation</h2> <p>In order to implement this, the following vin/vout contraints are used:</p> <h3 id="create"><a href="#create" aria-hidden="true" class="header-anchor">#</a> create</h3> <div class="language-bash extra-class"><pre class="language-bash"><code>vins.*: normal inputs
vout.0: txfee tag to oracle normal address
vout.1: change, <span class="token keyword">if</span> any
vout.n-1: opreturn with name and description and <span class="token function">format</span> <span class="token keyword">for</span> data
</code></pre></div><h3 id="register"><a href="#register" aria-hidden="true" class="header-anchor">#</a> register</h3> <div class="language-bash extra-class"><pre class="language-bash"><code>vins.*: normal inputs
vout.0: txfee tag to normal marker address
vout.1: baton CC utxo
vout.2: change, <span class="token keyword">if</span> any
vout.n-1: opreturn with oracletxid, pubkey and price per data point
</code></pre></div><h3 id="subscribe"><a href="#subscribe" aria-hidden="true" class="header-anchor">#</a> subscribe</h3> <div class="language-bash extra-class"><pre class="language-bash"><code>vins.*: normal inputs
vout.0: subscription fee to publishers CC address
vout.1: change, <span class="token keyword">if</span> any
vout.n-1: opreturn with oracletxid, registered provider's pubkey, amount
</code></pre></div><h3 id="data"><a href="#data" aria-hidden="true" class="header-anchor">#</a> data</h3> <div class="language-bash extra-class"><pre class="language-bash"><code>vin.0: normal input
vin.1: baton CC utxo <span class="token punctuation">(</span>most of the time<span class="token punctuation">)</span>
vin.2+: subscription or data vout.0
vout.0: change to publishers CC address
vout.1: baton CC utxo
vout.2: payment <span class="token keyword">for</span> dataprovider
vout.3: change, <span class="token keyword">if</span> any
vout.n-1: opreturn with oracletxid, prevbatontxid and data <span class="token keyword">in</span> proper <span class="token function">format</span>
</code></pre></div><p>The <code>oraclesdata</code> transaction is the most complex as it needs to find and spend the baton <code>utxo</code>, use the correct <code>datafee</code> and spend funds from the locked subscription funds. With the above, the oracles CC is complete and allows the creations of massively parallel data streams from multiple vendors that uses free market feedback via payments, ie. poorly performing providers wont get renewals.</p> <p>I expect that at first, the data providers will just be dapp developers deploying a working system including the required data, but its structure allows open market competition. Of course, specific dapps could restrict themselves to using only publishers from a whitelist of pubkeys. The potential usecases for oracles CC is quite varied and limited only by the imagination.</p></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/cc-jl/chapter10.html" class="prev">
          Chapter 10 - Channels Example
        </a></span> <span class="next"><a href="/cc-jl/chapter12.html">
          Chapter 12 - Limitless Possibilities
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/app.0159a207.js" defer></script><script src="/assets/js/70.49c1e23f.js" defer></script>
  </body>
</html>
